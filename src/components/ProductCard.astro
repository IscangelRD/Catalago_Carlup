---
export interface Product {
  id: number;
  name: string;
  description: string;
  price: number;
  image: string;
  gallery?: string[];
}

const { id, name, description, price, image, gallery = [] } = Astro.props;

// Número de WhatsApp del negocio
const whatsappNumber = "527751396916"; // Reemplázalo con tu número real.
// Mensaje dinámico con detalles del producto
const whatsappMessage = `Hola, estoy interesado en el producto: ${name},Quiero mas informacion.`;
const whatsappLink = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;
---

<div class="product-card">
  <!-- Imagen principal -->
  <img
    src={image}
    alt={name}
    class="main-image"
    onclick={`openModal(${id})`}
    loading="lazy"
  />
  <h3>{name}</h3>
  <p>{description}</p>
  <p class="price">${price}</p>

  <!-- Botón de WhatsApp -->
  <a
    href={whatsappLink}
    target="_blank"
    rel="noopener noreferrer"
    class="whatsapp-button"
  >
  <img src="/public/images/IconoWhats.png" alt="whatsApp" class="whatsapp-icon" 
  />


    Consultar por WhatsApp
  </a>

  <!-- Modal -->
  <div id={`modal-${id}`} class="modal" data-gallery={JSON.stringify(gallery)}>
    <div class="modal-content">
      <h1>{name}</h1>
      <button class="close-btn" onclick={`closeModal(${id})`}>&times;</button>

      <!-- Imagen Actual -->
      <div class="gallery">
        <img id={`current-image-${id}`} src={gallery[0] || ''} alt="Detalle" />
      </div>

      <!-- Controles de Navegación -->
      {gallery.length > 1 && (
        <div class="controls">
          <button onclick={`showPreviousImage(${id})`} class="prev-btn">← Anterior</button>
          <button onclick={`showNextImage(${id})`} class="next-btn">Siguiente →</button>
        </div>
      )}
    </div>
  </div>
</div>

<style>
  .product-card {
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 15px;
    text-align: center;
    background-color: white;
    max-width: 200px;
  }

  .product-card img {
    width: 100%;
    height: auto;
    border-radius: 10px;
    cursor: pointer;
  }

.whatsapp-button {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px; /* Espaciado entre la imagen y el texto */
  background-color: #25d366;
  color: white;
  padding: 10px 15px;
  border-radius: 5px;
  text-decoration: none;
  font-weight: bold;
}

.whatsapp-button:hover {
  background-color: #128c7e;
}
.whatsapp-icon {
  width: 32px !important;
  height: 32px !important;
}




  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .modal.show {
    display: flex;
  }

  .modal-content {
    background: linear-gradient(90deg, #ffffff, #dcdcdc);
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    max-width: 80%;
    max-height: 80%;
    overflow-y: auto;
    position: relative;
  }

  .close-btn {
    position: absolute;
    top: 10px;
    right: 20px;
    background: none;
    border: none;
    font-size: 2em;
    color: black;
    cursor: pointer;
  }

  .controls {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
  }

  .prev-btn, .next-btn {
    background: #ff6b6b;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
  }

  .prev-btn:hover, .next-btn:hover {
    background: #ff4b4b;
  }
</style>
